# 图片水印命令行工具 - 产品需求文档 (PRD)

## 产品名称
图片水印命令行工具

## 背景与目标
在日常生活中，用户可能需要为图片添加水印以标记拍摄时间或保护版权。本工具旨在通过命令行界面，快速为图片添加基于 EXIF 信息的水印，提供灵活的字体样式和位置设置，满足用户的个性化需求。

---

## 功能需求

1. **图片路径输入**
   - 用户通过命令行输入一个图片文件路径或目录路径。
   - 程序支持单张图片和批量处理。

2. **EXIF 信息读取**
   - 程序读取图片的 EXIF 信息，提取拍摄时间。
   - 拍摄时间格式化为 `YYYY-MM-DD`。

3. **水印设置**
   - 用户可以通过命令行参数设置以下水印属性：
     - **字体大小**：用户可指定字体大小（默认值：20）。
     - **字体颜色**：用户可指定颜色（默认值：黑色）。
     - **水印位置**：支持以下位置选项：
       - 左上角
       - 居中
       - 右下角

4. **水印绘制**
   - 程序将拍摄时间作为水印绘制到图片上。
   - 水印绘制不影响原图片质量。

5. **图片保存**
   - 程序将处理后的图片保存到一个新目录中：
     - 新目录命名为 `原目录名_watermark`。
     - 新目录为原目录的子目录。

---

## 非功能需求

1. **性能**
   - 支持批量处理，能够高效处理包含大量图片的目录。

2. **兼容性**
   - 支持常见图片格式（如 JPEG、PNG）。
   - 兼容 Windows 和其他主流操作系统。

3. **易用性**
   - 提供清晰的命令行参数说明和错误提示。

4. **安全性**
   - 对用户输入的路径和文件进行校验，避免非法操作。

---

## 用户交互流程

1. 用户通过命令行运行程序，输入图片路径。
2. 程序读取路径下的图片文件，提取 EXIF 信息中的拍摄时间。
3. 用户通过命令行参数设置水印样式（字体大小、颜色、位置）。
4. 程序将水印绘制到图片上，并保存到新目录。
5. 程序输出处理完成的提示信息。

---

## 技术实现

1. **编程语言**
   - Python

2. **依赖库**
   - `Pillow`：用于图片处理。
   - `piexif`：用于读取 EXIF 信息。
   - `os` 和 `shutil`：用于文件和目录操作。

3. **命令行解析**
   - 使用 `argparse` 库解析用户输入的命令行参数。

---

## 未来扩展

1. 支持更多水印内容（如自定义文本）。
2. 支持更多字体样式和透明度设置。
3. 提供 GUI 界面以提升用户体验。